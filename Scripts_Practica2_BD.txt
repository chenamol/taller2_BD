practica 2 Base de Datos 

***Creación de table space***

CREATE TABLESPACE GOFAR_TRAVEL DATAFILE
'C:\Users\Cesar H\Documents\taller2BD\gofar_travel.dbf' SIZE 500M, 
'C:\Users\Cesar H\Documents\taller2BD\gofar_travel.dbf' SIZE 300M,
'C:\Users\Cesar H\Documents\taller2BD\gofar_travel.dbf' SIZE 200M
AUTOEXTEND ON NEXT 500M MAXSIZE 1G
EXTENT MANAGEMENT LOCAL
SEGMENT SPACE MANAGEMENT AUTO
ONLINE;


***Creación usuario DBA y permisos***

ALTER SESSION SET "_ORACLE_SCRIPT"=true;

CREATE USER taller2
IDENTIFIED BY 123456 
DEFAULT TABLESPACE gofar_travel
QUOTA  UNLIMITED ON gofar_travel;

GRANT DBA TO taller2;

GRANT CONNECT TO taller2;

******Creación de Tablas********

 CREATE TABLE CLIENTES
( ID NUMBER(10) GENERATED AS IDENTITY,
  IDENTIFICACION NUMBER(10) NOT NULL,
  NOMBRE VARCHAR2(50) NOT NULL,
  APELLIDO VARCHAR2(50) NOT NULL,
  DIRECCION  VARCHAR2(50) NOT NULL,
  EMAIL VARCHAR2(40) ,
  TELEFONO VARCHAR2(20),
  CONSTRAINT CLIENTES_PK PRIMARY KEY (ID)
);


 CREATE TABLE FABRICANTES
( ID NUMBER(10) GENERATED AS IDENTITY,
  IDFABRICANTE NUMBER(10) NOT NULL,
  DESCRIPCION VARCHAR2(50) NOT NULL,
  CONSTRAINT FABRICANTE_PK PRIMARY KEY (ID));


 CREATE TABLE MARCAS
( ID NUMBER(10) GENERATED AS IDENTITY,
  IDMARCA NUMBER(10) NOT NULL,
  DESCRIPCION VARCHAR2(50) NOT NULL,
  CONSTRAINT MARCA_PK PRIMARY KEY (ID)
);


 CREATE TABLE VEHICULOS_NUEVOS
( ID NUMBER(10) GENERATED AS IDENTITY,
  VIN NUMBER(10) NOT NULL,
  IDMARCA NUMERIC(5) NOT NULL,
  MODELO NUMERIC(4),
  IDFABRICA NUMERIC(11) NOT NULL,
  ESTADO VARCHAR2(50),
  CONSTRAINT VEHICULOS_PK PRIMARY KEY (ID),
  CONSTRAINT VEHI_FABRI_FK FOREIGN KEY (IDFABRICA) REFERENCES FABRICANTES(ID),
  CONSTRAINT VEHI_MARCA_FK FOREIGN KEY (IDMARCA) REFERENCES MARCAS(ID)
  );

CREATE TABLE VEHICULOS_USADOS
( ID NUMBER(10) GENERATED AS IDENTITY,
  VIN NUMBER(10) NOT NULL,
  IDMARCA NUMERIC(5) NOT NULL,
  MODELO NUMERIC(4),
  IDFABRICA NUMERIC(11) NOT NULL,
  MARCA VARCHAR(20) NOT NULL,
  ESTADO VARCHAR2(50) NOT NULL,
  CONSTRAINT VEHICULOS_USADOS_PK PRIMARY KEY (ID)
  );

 CREATE TABLE VENDEDORES
( ID NUMBER(10) GENERATED AS IDENTITY,
  IDENTIFICACION NUMBER(10) NOT NULL,
  NOMBRE VARCHAR2(50) NOT NULL,
  APELLIDO VARCHAR2(50) NOT NULL,
  DIRECCION  VARCHAR2(50) NOT NULL,
  EMAIL VARCHAR2(40) ,
  TELEFONO VARCHAR2(20),
  IDTIPOVENDEDOR NUMBER(10)  NOT NULL,
  CONSTRAINT VENDEDOR_PK PRIMARY KEY (IDENTIFICACION),
  CONSTRAINT VENDE_TIPO_FK FOREIGN KEY (IDTIPOVENDEDOR) REFERENCES TIPOVENDEDOR (IDTIPO) 
 ); 

ALTER TABLE FACTURAS 
ADD CONSTRAINT FACTURA_VEHICULON_FK
FOREIGN KEY (ID_VEHICULO_NUEVO) 
references  VEHICULOS_NUEVOS (ID); 


ALTER TABLE FACTURAS 
ADD CONSTRAINT FACTURA_VEHICULON_FK
FOREIGN KEY (ID_VEHICULO_NUEVO) 
references  VEHICULOS_NUEVOS (ID); 


ALTER TABLE VEHICULOS_USADOS 
ADD ID_VEHICULO_CLIENTE NUMBER(12) NOT NULL;


ALTER TABLE VEHICULOS_USADOS 
ADD CONSTRAINT VEHICULO_CLIENTE_FK
FOREIGN KEY (ID_VEHICULO_CLIENTE) 
references  CLIENTES (ID); 

CREATE TABLE PARTEVEHICULOS
( ID NUMBER(10) GENERATED AS IDENTITY,
  COD_PARTE NUMBER(10) NOT NULL,
  DESCRIPCION VARCHAR2(50) NOT NULL,
  VALOR_COSTO NUMBER(10) NOT NULL,
  VALOR_PRECIO NUMBER(12) NOT NULL,
  CONSTRAINT PARTEVEH_PK PRIMARY KEY (ID));
  


CREATE TABLE DETALLE_FACTURAS
 (ID NUMBER(10) GENERATED AS IDENTITY,
  NRO_DETALLE_FACTURA NUMBER(10) NOT NULL,
  NRO_FACTURA NUMBER(10) NOT NULL,
  COD_PARTE NUMBER(10) NOT NULL,
  VLRPARTE NUMBER(10) NOT NULL,
  CONSTRAINT DETFACT_PK PRIMARY KEY (ID),
  CONSTRAINT DETFACT_FK FOREIGN KEY (NRO_FACTURA) REFERENCES FACTURAS(ID),
  CONSTRAINT DETFAC_PARTE_FK FOREIGN KEY (COD_PARTE) REFERENCES PARTEVEHICULOS (ID) 
 );
